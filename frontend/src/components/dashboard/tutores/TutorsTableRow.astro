---
import type { User } from "@lib/types/user";
import { Icon } from "astro-icon/components";

interface Props {
  tutor: User;
}

const { tutor } = Astro.props;

const tutorDetailUrl = `/dashboard/tutores/${tutor.profile?.documentId}`;
---

<tr class="hover:bg-white/50 transition-colors group">
  <td class="px-6 py-4 text-sm text-gray-700 font-medium hidden md:table-cell">
    {tutor.profile?.dni}
  </td>
  <td class="px-6 py-4">
    <div class="flex items-center gap-3">
      <div
        class="w-10 h-10 rounded-xl bg-rayito-blue/10 text-rayito-blue flex items-center justify-center font-bold text-sm group-hover:bg-rayito-blue group-hover:text-white transition-colors"
      >
        {tutor.profile?.names?.charAt(0) || "T"}
      </div>
      <div>
        <p class="font-semibold text-gray-900">
          {tutor.profile?.names}
          {tutor.profile?.surnames}
        </p>
        <p class="text-xs text-gray-400">@{tutor.username}</p>
      </div>
    </div>
  </td>
  
  <td class="px-6 py-4 text-sm text-gray-700 hidden md:table-cell">
    {tutor.profile?.cell_phone}
  </td>
  <td class="px-6 py-4 text-sm text-gray-600 hidden md:table-cell">
    {tutor.email}
  </td>
  <td class="px-6 py-4 hidden md:table-cell">
    <div class="flex flex-wrap gap-1">
      {tutor.profile?.students && tutor.profile.students.length > 0 ? (
        tutor.profile.students.map((student) => (
          <span class="inline-flex items-center px-2 py-0.5 rounded text-[10px] font-medium bg-rayito-blue/5 text-rayito-blue border border-rayito-blue/10">
            {student.names}
          </span>
        ))
      ) : (
        <span class="text-[10px] text-gray-400 italic">Sin alumnos</span>
      )}
    </div>
  </td>
  <td class="px-6 py-4">
    <div class="flex items-center justify-end space-x-3">
      <button 
        onclick={`window.dispatchEvent(new CustomEvent('open-create-student-from-tutor', { detail: { tutorId: '${tutor.profile?.documentId || ''}' } }))`}
        class="flex items-center gap-2 px-3 py-1.5 rounded-lg bg-rayito-blue/10 group-hover:bg-rayito-blue group-hover:text-white transition-all cursor-pointer"
      >
        <span class="text-rayito-blue group-hover:text-white text-xs font-medium">Nuevo</span>
        <Icon name="mdi:account-student" class="w-5 h-5 text-rayito-blue group-hover:text-white transition-all" />        
      </button>
      <a 
      href={tutorDetailUrl} 
      class="flex items-center gap-2 px-3 py-1.5 rounded-lg bg-rayito-blue/10 group-hover:bg-rayito-blue group-hover:text-white transition-all cursor-pointer"
      >        
        <Icon name="mdi:dots-horizontal" class="w-5 h-5 text-gray-400 hover:text-rayito-blue transition-all" />
      </a>
    </div>    
  </td>
</tr>
