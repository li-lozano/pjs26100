---
import type { Student } from "@lib/types/student";

interface Props {
  student: Student;
}

const { student } = Astro.props;

// Calcular edad
function calculateAge(birthday: string): number {
  const birthDate = new Date(birthday);
  const today = new Date();
  let age = today.getFullYear() - birthDate.getFullYear();
  const monthDiff = today.getMonth() - birthDate.getMonth();
  if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {
    age--;
  }
  return age;
}

const age = calculateAge(student.birthday);
const initials = student.names.charAt(0) + student.surnames.charAt(0);
---

<div
  class="bg-white/80 backdrop-blur-md rounded-2xl p-6 border border-gray-100 shadow-sm hover:shadow-xl transition-all duration-300 group hover:-translate-y-1"
>
  <div class="flex items-start space-x-4">
    <!-- Avatar -->
    <div
      class="w-16 h-16 rounded-full bg-rayito-yellow flex items-center justify-center text-white font-bold text-xl shadow-lg group-hover:scale-110 transition-transform shrink-0"
    >
      {initials}
    </div>

    <!-- Info -->
    <div class="flex-1 min-w-0">
      <h3 class="text-lg font-bold text-gray-900 truncate mb-1">
        {student.names} {student.surnames}
      </h3>
      <div class="space-y-1 text-sm text-gray-600">
        <p>
          <span class="font-medium">DNI:</span>
          {student.dni}
        </p>
        <p>
          <span class="font-medium">Edad:</span>
          {age} años
        </p>
        <p>
          <span class="font-medium">Género:</span>
          {student.gender === "M" ? "Masculino" : "Femenino"}
        </p>
      </div>
    </div>
  </div>

  <!-- Additional Info (Optional) -->
  <div class="mt-4 pt-4 border-t border-gray-100">
    <p class="text-xs text-gray-500">
      <span class="font-medium">Dirección:</span>
      {student.address || "No especificada"}
    </p>
  </div>

  <!-- Status Badge -->
  {student.student_status === "Pendiente" && (
    <div class="mt-3">
      <span class="inline-block px-3 py-1 bg-yellow-100 text-yellow-800 rounded-lg text-xs font-medium">
        ⏳ Pendiente de Aprobación
      </span>
    </div>
  )}
  {student.student_status === "Activo" && (
    <div class="mt-3">
      <span class="inline-block px-3 py-1 bg-green-100 text-green-800 rounded-lg text-xs font-medium">
        ✅ Activo
      </span>
    </div>
  )}
  {student.student_status === "Rechazado" && (
    <div class="mt-3">
      <span class="inline-block px-3 py-1 bg-red-100 text-red-800 rounded-lg text-xs font-medium">
        ❌ Rechazado
      </span>
    </div>
  )}
</div>
