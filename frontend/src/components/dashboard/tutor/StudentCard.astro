---
import type { Student } from "@lib/types/student";
import type { Enrollment } from "@lib/types/enrollment";
import { calculateAge } from "@lib/utils/date";
import StudentStatusBadge from "./StudentStatusBadge.astro";


interface Props {
  student: Student;
  enrollmentsList: Enrollment[];
}

const { student, enrollmentsList } = Astro.props;

const age = calculateAge(student.birthday);
const initials = student.names.charAt(0) + student.surnames.charAt(0);


const studentEnrollments = enrollmentsList.filter((enrollment) => {
  return enrollment.student?.documentId === student.documentId
});

---

<div
  class="bg-white/80 backdrop-blur-md rounded-2xl p-6 border border-gray-100 shadow-sm hover:shadow-xl transition-all duration-300 group hover:-translate-y-1"
>
  <div class="flex items-start space-x-4">
    <!-- Avatar -->
    <div
      class="w-16 h-16 rounded-full bg-rayito-yellow flex items-center justify-center text-white font-bold text-xl shadow-lg group-hover:scale-110 transition-transform shrink-0"
    >
      {initials}
    </div>

    <!-- Info -->
    <div class="flex-1 min-w-0">
      <h3 class="text-lg font-bold text-gray-900 truncate mb-1">
        {student.names} {student.surnames}
      </h3>
      <div class="space-y-1 text-sm text-gray-600">
        <p>
          <span class="font-medium">DNI:</span>
          {student.dni}
        </p>
        <p>
          <span class="font-medium">Edad:</span>
          {age} años
        </p>
        <p>
          <span class="font-medium">Género:</span>
          {student.gender}
        </p>
      </div>
    </div>
  </div>

  <!-- Additional Info (Optional) -->
  <div class="mt-4 pt-4 border-t border-gray-100">
    <p class="text-xs text-gray-500">
      <span class="font-medium">Dirección:</span>
      {student.address || "No especificada"}
    </p>
  </div>

  <!-- Status Badge Component -->   
  <StudentStatusBadge status={student.student_status} studentEnrollments={studentEnrollments} />
</div>
