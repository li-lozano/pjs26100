---
import { Icon } from "astro-icon/components";

interface Props {
  message: string;
}

const { message } = Astro.props;
// Generamos un ID Ãºnico para que el script no interfiera con otros elementos.
const uniqueId = `error-message-${Math.random().toString(36).substring(2, 9)}`;
---

<div
  id={uniqueId}
  class="animate-in fade-in slide-in-from-top-4 fixed top-4 left-1/2 z-50 w-[90%] max-w-md -translate-x-1/2 duration-300"
  role="alert"
>
  <div
    class="relative flex items-center gap-3 overflow-hidden rounded-2xl border border-red-500/30 bg-red-900/90 px-4 py-3 shadow-[0_20px_50px_rgba(0,0,0,0.3)] backdrop-blur-xl"
  >
    <!-- Decorative gradient background -->
    <div
      class="absolute inset-0 opacity-10"
      style="background: linear-gradient(135deg, var(--color-rayito-pink) 0%, var(--color-rayito-orange) 100%);"
    >
    </div>

    <div
      class="relative z-10 flex h-10 w-10 shrink-0 items-center justify-center rounded-xl bg-red-500/20"
    >
      <Icon name="mdi:alert-circle" class="h-6 w-6 text-red-400" />
    </div>

    <div
      class="relative z-10 flex-1 text-sm leading-relaxed font-semibold text-white"
    >
      {message}
    </div>

    <button
      onclick={`document.getElementById('${uniqueId}').remove()`}
      class="relative z-10 shrink-0 rounded-lg p-1.5 text-red-300/60 transition-all duration-200 hover:bg-red-500/20 hover:text-red-300"
      aria-label="Cerrar"
    >
      <Icon name="mdi:close" class="h-5 w-5" />
    </button>
  </div>
</div>

<script define:vars={{ uniqueId }}>
  const element = document.getElementById(uniqueId);
  if (element) {
    setTimeout(() => {
      element.classList.add("animate-out", "fade-out", "slide-out-to-top-4");
      setTimeout(() => element.remove(), 300);
    }, 6000);
  }
</script>
