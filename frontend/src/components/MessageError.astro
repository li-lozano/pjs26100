---
import { Icon } from "astro-icon/components";

interface Props {
  message: string;
}

const { message } = Astro.props;
// Generamos un ID Ãºnico para que el script no interfiera con otros elementos.
const uniqueId = `error-message-${Math.random().toString(36).substring(2, 9)}`;
---

<div
  id={uniqueId}
  class="fixed top-4 left-1/2 -translate-x-1/2 z-50 w-[90%] max-w-md animate-in fade-in slide-in-from-top-4 duration-300"
  role="alert"
>
  <div
    class="bg-red-900/90 backdrop-blur-xl border border-red-500/30 rounded-2xl shadow-[0_20px_50px_rgba(0,0,0,0.3)] px-4 py-3 flex items-center gap-3 relative overflow-hidden"
  >
    <!-- Decorative gradient background -->
    <div
      class="absolute inset-0 opacity-10"
      style="background: linear-gradient(135deg, var(--color-rayito-pink) 0%, var(--color-rayito-orange) 100%);"
    >
    </div>

    <div
      class="shrink-0 w-10 h-10 rounded-xl flex items-center justify-center relative z-10 bg-red-500/20"
    >
      <Icon name="mdi:alert-circle" class="w-6 h-6 text-red-400" />
    </div>

    <div
      class="flex-1 text-sm font-semibold leading-relaxed text-white relative z-10"
    >
      {message}
    </div>

    <button
      onclick={`document.getElementById('${uniqueId}').remove()`}
      class="shrink-0 p-1.5 rounded-lg transition-all duration-200 relative z-10 text-red-300/60 hover:bg-red-500/20 hover:text-red-300"
      aria-label="Cerrar"
    >
      <Icon name="mdi:close" class="w-5 h-5" />
    </button>
  </div>
</div>

<script define:vars={{ uniqueId }}>
  const element = document.getElementById(uniqueId);
  if (element) {
    setTimeout(() => {
      element.classList.add("animate-out", "fade-out", "slide-out-to-top-4");
      setTimeout(() => element.remove(), 300);
    }, 6000);
  }
</script>
