---
import "@styles/global.css";
import MessageError from "@components/MessageError.astro";
import MessageSuccess from "@components/MessageSuccess.astro";
import Sidebar from "@components/dashboard/Sidebar.astro";
import MobileSidebar from "@components/dashboard/MobileSidebar.astro";
import { Icon } from "astro-icon/components";

const { pageTitle } = Astro.props;

// Leer mensajes de error/Ã©xito desde query params
const errorMessage = Astro.url.searchParams.get("error");
const successMessage = Astro.url.searchParams.get("success");
---

<!doctype html>
<html lang="es" class="h-full bg-gray-50">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<link rel="icon" href="/favicon.ico" />
		<meta name="generator" content={Astro.generator} />
		<title>Rayito de Luz - {pageTitle}</title>
		<link
			href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap"
			rel="stylesheet"
		/>
	</head>
	<body class="h-full overflow-hidden text-text-primary">
		<div id="app" class="flex h-full relative">
			<!-- Background Blobs -->
			<div class="fixed inset-0 overflow-hidden pointer-events-none -z-10">
				<div
					class="absolute top-0 -left-4 w-96 h-96 bg-rayito-blue/5 rounded-full mix-blend-multiply filter blur-3xl opacity-70 animate-blob"
				>
				</div>
				<div
					class="absolute top-0 -right-4 w-96 h-96 bg-rayito-yellow/5 rounded-full mix-blend-multiply filter blur-3xl opacity-70 animate-blob animation-delay-2000"
				>
				</div>
				<div
					class="absolute -bottom-8 left-20 w-96 h-96 bg-rayito-pink/5 rounded-full mix-blend-multiply filter blur-3xl opacity-70 animate-blob animation-delay-4000"
				>
				</div>
			</div>

			<Sidebar />
			<MobileSidebar />

			<!-- Main Content Area -->
			<main class="flex-1 flex flex-col min-w-0 overflow-hidden relative">
				<!-- Top Bar -->
				<header
					class="h-16 bg-white/50 backdrop-blur-sm border-b border-gray-100 flex items-center justify-between px-4 md:px-8 z-10"
				>
					<div class="flex items-center">
						<button
							id="open-mobile-menu"
							class="p-2 mr-2 text-gray-500 md:hidden hover:text-rayito-blue"
							aria-label="Abrir menÃº"
						>
							<Icon name="mdi:menu" class="w-8 h-8" />
						</button>
						<h1
							class="text-lg md:text-xl font-bold bg-linear-to-r from-rayito-blue to-rayito-sky bg-clip-text text-transparent truncate"
						>
							{pageTitle}
						</h1>
					</div>
					<div class="flex items-center space-x-4">
						<button
							class="p-2 text-gray-400 hover:text-rayito-blue transition-colors"
						>
							ðŸ””
						</button>
					</div>
				</header>

				<!-- Content Content -->
				<div class="flex-1 overflow-y-auto p-4 md:p-8 relative">
					{
						errorMessage && (
							<div class="mb-6">
								<MessageError message={errorMessage} />
							</div>
						)
					}
					{
						successMessage && (
							<div class="mb-6">
								<MessageSuccess message={successMessage} />
							</div>
						)
					}
					<slot />
				</div>
			</main>
		</div>
	</body>
</html>
