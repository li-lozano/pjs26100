---
import "@styles/global.css";
import MessageError from "@components/MessageError.astro";
import MessageSuccess from "@components/MessageSuccess.astro";
import Sidebar from "@components/dashboard/Sidebar.astro";
import MobileSidebar from "@components/dashboard/MobileSidebar.astro";
import { Icon } from "astro-icon/components";

const { pageTitle } = Astro.props;

// Leer mensajes de error/Ã©xito desde query params
const errorMessage = Astro.url.searchParams.get("error");
const successMessage = Astro.url.searchParams.get("success");
---

<!doctype html>
<html lang="es" class="h-full bg-gray-50">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="icon" href="/favicon.ico" />
    <meta name="generator" content={Astro.generator} />
    <title>Rayito de Luz - {pageTitle}</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body class="text-text-primary h-full overflow-hidden">
    <div id="app" class="relative flex h-full">
      <!-- Background Blobs -->
      <div class="pointer-events-none fixed inset-0 -z-10 overflow-hidden">
        <div
          class="bg-rayito-blue/5 animate-blob absolute top-0 -left-4 h-96 w-96 rounded-full opacity-70 mix-blend-multiply blur-3xl filter"
        >
        </div>
        <div
          class="bg-rayito-yellow/5 animate-blob animation-delay-2000 absolute top-0 -right-4 h-96 w-96 rounded-full opacity-70 mix-blend-multiply blur-3xl filter"
        >
        </div>
        <div
          class="bg-rayito-pink/5 animate-blob animation-delay-4000 absolute -bottom-8 left-20 h-96 w-96 rounded-full opacity-70 mix-blend-multiply blur-3xl filter"
        >
        </div>
      </div>

      <Sidebar />
      <MobileSidebar />

      <!-- Main Content Area -->
      <main class="relative flex min-w-0 flex-1 flex-col overflow-hidden">
        <!-- Top Bar -->
        <header
          class="z-10 flex h-16 items-center justify-between border-b border-gray-100 bg-white/50 px-4 backdrop-blur-sm md:px-8"
        >
          <div class="flex items-center">
            <button
              id="open-mobile-menu"
              class="hover:text-rayito-blue mr-2 p-2 text-gray-500 md:hidden"
              aria-label="Abrir menÃº"
            >
              <Icon name="mdi:menu" class="h-8 w-8" />
            </button>
            <h1
              class="from-rayito-blue to-rayito-sky truncate bg-linear-to-r bg-clip-text text-lg font-bold text-transparent md:text-xl"
            >
              {pageTitle}
            </h1>
          </div>
          <div class="flex items-center space-x-4">
            <button
              class="hover:text-rayito-blue p-2 text-gray-400 transition-colors"
            >
              ðŸ””
            </button>
          </div>
        </header>

        <!-- Content Content -->
        <div class="relative flex-1 overflow-y-auto p-4 md:p-8">
          {
            errorMessage && (
              <div class="mb-6">
                <MessageError message={errorMessage} />
              </div>
            )
          }
          {
            successMessage && (
              <div class="mb-6">
                <MessageSuccess message={successMessage} />
              </div>
            )
          }
          <slot />
        </div>
      </main>
    </div>
  </body>
</html>
